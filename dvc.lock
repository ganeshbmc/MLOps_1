schema: '2.0'
stages:
  prepare_data:
    cmd: python scripts/prepare_data.py
    deps:
    - path: data/iris_entity.csv
      hash: md5
      md5: 236b92ba5aada0671c265bd508c46310
      size: 9926
    - path: helpers/feast_utils.py
      hash: md5
      md5: da00271ef52ed954e03072be334e33fa
      size: 3667
    outs:
    - path: data/test_2025.csv
      hash: md5
      md5: 719674ec756a37a0bc106b1189fc4e13
      size: 6515
    - path: data/train_2023.csv
      hash: md5
      md5: ece5fb9cd7dbed5eae68866a656adefb
      size: 8573
    - path: data/train_2023_2024.csv
      hash: md5
      md5: ebe538f6c0fed54eb1b9ed0bd1fc98ef
      size: 18704
    - path: data/train_2024.csv
      hash: md5
      md5: 670190e51e76f52e23403ccf59036c63
      size: 10215
  train_2023:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023.csv
      --model_out artifacts/model_2023.joblib --metrics_out metrics/metrics_2023.json
      --experiment_name hpt_iris_2023
    deps:
    - path: data/train_2023.csv
      hash: md5
      md5: ece5fb9cd7dbed5eae68866a656adefb
      size: 8573
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 3392792c2c6b3eb33b7019d4436a1238
      size: 75489
    - path: metrics/metrics_2023.json
      hash: md5
      md5: abe1236ecfc2278a5e408640752ca9e7
      size: 90
  evaluate_2023:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023.json --experiment_name
      hpt_iris_2023
    deps:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 3392792c2c6b3eb33b7019d4436a1238
      size: 75489
    - path: data/test_2025.csv
      hash: md5
      md5: 719674ec756a37a0bc106b1189fc4e13
      size: 6515
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023.json
      hash: md5
      md5: 01f19ba9febbb912148727d0cb17dcc8
      size: 849
  train_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2024.csv
      --model_out artifacts/model_2024.joblib --metrics_out metrics/metrics_2024.json
      --experiment_name hpt_iris_2024
    deps:
    - path: data/train_2024.csv
      hash: md5
      md5: 670190e51e76f52e23403ccf59036c63
      size: 10215
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 57fd63cb17bf11f7b0e2ef22e233fd19
      size: 51201
    - path: metrics/metrics_2024.json
      hash: md5
      md5: 80346cf08a216530ad5eea916e398c5f
      size: 90
  evaluate_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2024.json --experiment_name
      hpt_iris_2024
    deps:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 57fd63cb17bf11f7b0e2ef22e233fd19
      size: 51201
    - path: data/test_2025.csv
      hash: md5
      md5: 719674ec756a37a0bc106b1189fc4e13
      size: 6515
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2024.json
      hash: md5
      md5: 075e074a39ec4936cdec9e1ffb26bb5d
      size: 837
  train_2023_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023_2024.csv
      --model_out artifacts/model_2023_2024.joblib --metrics_out metrics/metrics_2023_2024.json
      --experiment_name hpt_iris_2023_2024
    deps:
    - path: data/train_2023_2024.csv
      hash: md5
      md5: ebe538f6c0fed54eb1b9ed0bd1fc98ef
      size: 18704
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: 62db2475bc253262d7aa1287ae55b943
      size: 365153
    - path: metrics/metrics_2023_2024.json
      hash: md5
      md5: a333d2da3292eee1318a64b40763f540
      size: 79
  evaluate_2023_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023_2024.json --experiment_name
      hpt_iris_2023_2024
    deps:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: 62db2475bc253262d7aa1287ae55b943
      size: 365153
    - path: data/test_2025.csv
      hash: md5
      md5: 719674ec756a37a0bc106b1189fc4e13
      size: 6515
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023_2024.json
      hash: md5
      md5: 8feb560f5a16a70e50408b1f1f866ad3
      size: 866
