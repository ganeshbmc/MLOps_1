schema: '2.0'
stages:
  prepare_data:
    cmd: python scripts/prepare_data.py
    deps:
    - path: data/iris_entity.csv
      hash: md5
      md5: 236b92ba5aada0671c265bd508c46310
      size: 9926
    - path: helpers/feast_utils.py
      hash: md5
      md5: da00271ef52ed954e03072be334e33fa
      size: 3667
    outs:
    - path: data/test_2025.csv
      hash: md5
      md5: 1d0a952facc0cd34fd2329226c74bfb0
      size: 6522
    - path: data/train_2023.csv
      hash: md5
      md5: 63d8b60acc8e20b57e804a8424d147e3
      size: 8852
    - path: data/train_2023_2024.csv
      hash: md5
      md5: 3dbfb6f426efc73a04ddab20dcac788d
      size: 19004
    - path: data/train_2024.csv
      hash: md5
      md5: 329270f2daad4981fac619c721461981
      size: 10236
  train_2023:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023.csv
      --model_out artifacts/model_2023.joblib --metrics_out metrics/metrics_2023.json
      --experiment_name hpt_iris_2023
    deps:
    - path: data/train_2023.csv
      hash: md5
      md5: 63d8b60acc8e20b57e804a8424d147e3
      size: 8852
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 550d7c2ce43325508af01601db6686ee
      size: 95361
    - path: metrics/metrics_2023.json
      hash: md5
      md5: 47372653b3c0f3af6a9348f8f6fdaf1d
      size: 77
  evaluate_2023:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023.json --experiment_name
      hpt_iris_2023
    deps:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 550d7c2ce43325508af01601db6686ee
      size: 95361
    - path: data/test_2025.csv
      hash: md5
      md5: 1d0a952facc0cd34fd2329226c74bfb0
      size: 6522
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023.json
      hash: md5
      md5: b2987634ea58d6977d3467a703562d90
      size: 839
  train_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2024.csv
      --model_out artifacts/model_2024.joblib --metrics_out metrics/metrics_2024.json
      --experiment_name hpt_iris_2024
    deps:
    - path: data/train_2024.csv
      hash: md5
      md5: 329270f2daad4981fac619c721461981
      size: 10236
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 997878b9d5490a4def00094615b431be
      size: 236161
    - path: metrics/metrics_2024.json
      hash: md5
      md5: 50cdbc4a3046cf4e56dc578d089baf7d
      size: 90
  evaluate_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2024.json --experiment_name
      hpt_iris_2024
    deps:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 997878b9d5490a4def00094615b431be
      size: 236161
    - path: data/test_2025.csv
      hash: md5
      md5: 1d0a952facc0cd34fd2329226c74bfb0
      size: 6522
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2024.json
      hash: md5
      md5: 81cb3a09951bb335d00ab5cd3d8e5ece
      size: 838
  train_2023_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023_2024.csv
      --model_out artifacts/model_2023_2024.joblib --metrics_out metrics/metrics_2023_2024.json
      --experiment_name hpt_iris_2023_2024
    deps:
    - path: data/train_2023_2024.csv
      hash: md5
      md5: 3dbfb6f426efc73a04ddab20dcac788d
      size: 19004
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: 6f1c80f4e98cf93440d99c44b7785295
      size: 111745
    - path: metrics/metrics_2023_2024.json
      hash: md5
      md5: e37a8ef74e232d58c5879b89c918c5f6
      size: 90
  evaluate_2023_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023_2024.json --experiment_name
      hpt_iris_2023_2024
    deps:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: 6f1c80f4e98cf93440d99c44b7785295
      size: 111745
    - path: data/test_2025.csv
      hash: md5
      md5: 1d0a952facc0cd34fd2329226c74bfb0
      size: 6522
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023_2024.json
      hash: md5
      md5: 7e4b84ba942e7010372bbf7cdc9230f1
      size: 825
