schema: '2.0'
stages:
  prepare_data:
    cmd: python scripts/prepare_data.py
    deps:
    - path: data/iris_entity.csv
      hash: md5
      md5: 236b92ba5aada0671c265bd508c46310
      size: 9926
    - path: helpers/feast_utils.py
      hash: md5
      md5: da00271ef52ed954e03072be334e33fa
      size: 3667
    outs:
    - path: data/test_2025.csv
      hash: md5
      md5: af9754f5271ff97b7c9d15c4647baf9b
      size: 6522
    - path: data/train_2023.csv
      hash: md5
      md5: 4c886fccb0be4ef7118b0f41f6aef6b2
      size: 11104
    - path: data/train_2023_2024.csv
      hash: md5
      md5: 6b45067fc3e57c3facbc9b361736f8b6
      size: 21273
    - path: data/train_2024.csv
      hash: md5
      md5: df424246e7005e6c361c601663e1e3cf
      size: 10253
  train_2023:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023.csv
      --model_out artifacts/model_2023.joblib --metrics_out metrics/metrics_2023.json
      --experiment_name hpt_iris_2023
    deps:
    - path: data/train_2023.csv
      hash: md5
      md5: 4c886fccb0be4ef7118b0f41f6aef6b2
      size: 11104
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 1cc3b7b8d53557365ff91b16995cc84a
      size: 123361
    - path: metrics/metrics_2023.json
      hash: md5
      md5: 51542bf74eb86bdf151ac34e1c02c10e
      size: 90
  evaluate_2023:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023.json --experiment_name
      hpt_iris_2023
    deps:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 1cc3b7b8d53557365ff91b16995cc84a
      size: 123361
    - path: data/test_2025.csv
      hash: md5
      md5: af9754f5271ff97b7c9d15c4647baf9b
      size: 6522
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023.json
      hash: md5
      md5: 4fc1c4cd8bd4d9c32f6b5493242d4dc5
      size: 813
  train_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2024.csv
      --model_out artifacts/model_2024.joblib --metrics_out metrics/metrics_2024.json
      --experiment_name hpt_iris_2024
    deps:
    - path: data/train_2024.csv
      hash: md5
      md5: df424246e7005e6c361c601663e1e3cf
      size: 10253
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 1d71af8dd58bc5b9b04797bb622d5339
      size: 155361
    - path: metrics/metrics_2024.json
      hash: md5
      md5: ba4117f369f8863a52848fb6edef0940
      size: 91
  evaluate_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2024.json --experiment_name
      hpt_iris_2024
    deps:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 1d71af8dd58bc5b9b04797bb622d5339
      size: 155361
    - path: data/test_2025.csv
      hash: md5
      md5: af9754f5271ff97b7c9d15c4647baf9b
      size: 6522
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2024.json
      hash: md5
      md5: c42bb3db57aa8b2a93919c71aad08885
      size: 840
  train_2023_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023_2024.csv
      --model_out artifacts/model_2023_2024.joblib --metrics_out metrics/metrics_2023_2024.json
      --experiment_name hpt_iris_2023_2024
    deps:
    - path: data/train_2023_2024.csv
      hash: md5
      md5: 6b45067fc3e57c3facbc9b361736f8b6
      size: 21273
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: 042bf7f558cea70de0723bbbf64a7ada
      size: 467073
    - path: metrics/metrics_2023_2024.json
      hash: md5
      md5: 80dd74ec3719e7b27c4759cf47f421c4
      size: 91
  evaluate_2023_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023_2024.json --experiment_name
      hpt_iris_2023_2024
    deps:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: 042bf7f558cea70de0723bbbf64a7ada
      size: 467073
    - path: data/test_2025.csv
      hash: md5
      md5: af9754f5271ff97b7c9d15c4647baf9b
      size: 6522
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023_2024.json
      hash: md5
      md5: c22d10ac43af028dcbaabec513fe60b8
      size: 840
