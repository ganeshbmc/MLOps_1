schema: '2.0'
stages:
  prepare_data:
    cmd: python scripts/prepare_data.py
    deps:
    - path: data/iris_entity.csv
      hash: md5
      md5: 236b92ba5aada0671c265bd508c46310
      size: 9926
    - path: helpers/feast_utils.py
      hash: md5
      md5: da00271ef52ed954e03072be334e33fa
      size: 3667
    outs:
    - path: data/test_2025.csv
      hash: md5
      md5: c8615c333626943cc05297ac72b215a3
      size: 6512
    - path: data/train_2023.csv
      hash: md5
      md5: 196fe46b00cb942b21fdab7004489249
      size: 9568
    - path: data/train_2023_2024.csv
      hash: md5
      md5: 865ba21170c280ecb1bf68556e305093
      size: 19715
    - path: data/train_2024.csv
      hash: md5
      md5: 3bb0fba62be720c5b36c437783228755
      size: 10231
  train_2023:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023.csv
      --model_out artifacts/model_2023.joblib --metrics_out metrics/metrics_2023.json
      --experiment_name hpt_iris_2023
    deps:
    - path: data/train_2023.csv
      hash: md5
      md5: 196fe46b00cb942b21fdab7004489249
      size: 9568
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 3e1d5382047d70a4a5ff6bf10d335da3
      size: 120017
    - path: metrics/metrics_2023.json
      hash: md5
      md5: feeb308139217efb100d8b3b607399a6
      size: 90
  evaluate_2023:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023.json --experiment_name
      hpt_iris_2023
    deps:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 3e1d5382047d70a4a5ff6bf10d335da3
      size: 120017
    - path: data/test_2025.csv
      hash: md5
      md5: c8615c333626943cc05297ac72b215a3
      size: 6512
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023.json
      hash: md5
      md5: 078a794d56f965975c6eddd28e8e9813
      size: 833
  train_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2024.csv
      --model_out artifacts/model_2024.joblib --metrics_out metrics/metrics_2024.json
      --experiment_name hpt_iris_2024
    deps:
    - path: data/train_2024.csv
      hash: md5
      md5: 3bb0fba62be720c5b36c437783228755
      size: 10231
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 2975bccbf80013d3bcaf632c77bbd669
      size: 102225
    - path: metrics/metrics_2024.json
      hash: md5
      md5: c30c3f1a0dce4e156c6aa705a48c3892
      size: 91
  evaluate_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2024.json --experiment_name
      hpt_iris_2024
    deps:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 2975bccbf80013d3bcaf632c77bbd669
      size: 102225
    - path: data/test_2025.csv
      hash: md5
      md5: c8615c333626943cc05297ac72b215a3
      size: 6512
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2024.json
      hash: md5
      md5: 81cf94e2a9d72878fdd709d70578a3ed
      size: 852
  train_2023_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023_2024.csv
      --model_out artifacts/model_2023_2024.joblib --metrics_out metrics/metrics_2023_2024.json
      --experiment_name hpt_iris_2023_2024
    deps:
    - path: data/train_2023_2024.csv
      hash: md5
      md5: 865ba21170c280ecb1bf68556e305093
      size: 19715
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: 864d6ae7191ae9df5679f5ed870e5800
      size: 518273
    - path: metrics/metrics_2023_2024.json
      hash: md5
      md5: 5d199e0049bc6fbc167dfddfd40da0ed
      size: 91
  evaluate_2023_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023_2024.json --experiment_name
      hpt_iris_2023_2024
    deps:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: 864d6ae7191ae9df5679f5ed870e5800
      size: 518273
    - path: data/test_2025.csv
      hash: md5
      md5: c8615c333626943cc05297ac72b215a3
      size: 6512
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023_2024.json
      hash: md5
      md5: ad98f5f7689c71b6f67420756e3be0af
      size: 779
