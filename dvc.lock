schema: '2.0'
stages:
  prepare_data:
    cmd: python scripts/prepare_data.py
    deps:
    - path: data/iris_entity.csv
      hash: md5
      md5: 236b92ba5aada0671c265bd508c46310
      size: 9926
    - path: helpers/feast_utils.py
      hash: md5
      md5: da00271ef52ed954e03072be334e33fa
      size: 3667
    outs:
    - path: data/test_2025.csv
      hash: md5
      md5: 61273f6afbd1fda9f744ed8119601564
      size: 6547
    - path: data/train_2023.csv
      hash: md5
      md5: 9b5d121c099b18886d6a03fe5a9a18eb
      size: 12846
    - path: data/train_2023_2024.csv
      hash: md5
      md5: f7407b7dd6f2af9797ef8ec31edb6a50
      size: 23040
    - path: data/train_2024.csv
      hash: md5
      md5: 7f4df77399517c22cec92c71b6013dcb
      size: 10278
  train_2023:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023.csv
      --model_out artifacts/model_2023.joblib --metrics_out metrics/metrics_2023.json
      --experiment_name hpt_iris_2023
    deps:
    - path: data/train_2023.csv
      hash: md5
      md5: 9b5d121c099b18886d6a03fe5a9a18eb
      size: 12846
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 9352d5ed9afe2630e028b9e2602c7823
      size: 213473
    - path: metrics/metrics_2023.json
      hash: md5
      md5: 5596191e82dd611357ebd29415b18fc1
      size: 90
  evaluate_2023:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023.json --experiment_name
      hpt_iris_2023
    deps:
    - path: artifacts/model_2023.joblib
      hash: md5
      md5: 9352d5ed9afe2630e028b9e2602c7823
      size: 213473
    - path: data/test_2025.csv
      hash: md5
      md5: 61273f6afbd1fda9f744ed8119601564
      size: 6547
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023.json
      hash: md5
      md5: 2fdd328bc487ac1f7f37c93a02cb56dc
      size: 855
  train_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2024.csv
      --model_out artifacts/model_2024.joblib --metrics_out metrics/metrics_2024.json
      --experiment_name hpt_iris_2024
    deps:
    - path: data/train_2024.csv
      hash: md5
      md5: 7f4df77399517c22cec92c71b6013dcb
      size: 10278
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 4d090182012151c791c976279e2df8cc
      size: 52961
    - path: metrics/metrics_2024.json
      hash: md5
      md5: cba0520eed48b9391f30ccae606a80b6
      size: 90
  evaluate_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2024.json --experiment_name
      hpt_iris_2024
    deps:
    - path: artifacts/model_2024.joblib
      hash: md5
      md5: 4d090182012151c791c976279e2df8cc
      size: 52961
    - path: data/test_2025.csv
      hash: md5
      md5: 61273f6afbd1fda9f744ed8119601564
      size: 6547
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2024.json
      hash: md5
      md5: 18f26422f52e0d3f04e6d67b4e990cf3
      size: 796
  train_2023_2024:
    cmd: python scripts/train_with_mlflow_tracking.py --train_csv data/train_2023_2024.csv
      --model_out artifacts/model_2023_2024.joblib --metrics_out metrics/metrics_2023_2024.json
      --experiment_name hpt_iris_2023_2024
    deps:
    - path: data/train_2023_2024.csv
      hash: md5
      md5: f7407b7dd6f2af9797ef8ec31edb6a50
      size: 23040
    - path: scripts/train_with_mlflow_tracking.py
      hash: md5
      md5: 317209810e0141c8f5c88d2bf90d51aa
      size: 4130
    outs:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: ef756840fe26ccc87e7f048c808d17c3
      size: 137089
    - path: metrics/metrics_2023_2024.json
      hash: md5
      md5: 4921c743356b75fd9d24fd2ecee43ec7
      size: 76
  evaluate_2023_2024:
    cmd: python scripts/evaluate_with_mlflow_tracking.py --model artifacts/model_2023_2024.joblib
      --test_csv data/test_2025.csv --metrics_out metrics/eval_2023_2024.json --experiment_name
      hpt_iris_2023_2024
    deps:
    - path: artifacts/model_2023_2024.joblib
      hash: md5
      md5: ef756840fe26ccc87e7f048c808d17c3
      size: 137089
    - path: data/test_2025.csv
      hash: md5
      md5: 61273f6afbd1fda9f744ed8119601564
      size: 6547
    - path: scripts/evaluate_with_mlflow_tracking.py
      hash: md5
      md5: ec9a57dd0b450256424342a82b1d9c7f
      size: 3179
    outs:
    - path: metrics/eval_2023_2024.json
      hash: md5
      md5: 7e490bf975e2d7bd41f5fa93ab0facbe
      size: 771
